{% extends "account/base.html" %}
{% load static %}
{% load i18n %}
{% load account socialaccount %}
{% load crispy_forms_tags %}

{% block title %}Sign up{% endblock %}

{% block content %}
<div class="">
	<div class="flex items-center justify-center">
		<div class="text-2xl font-semibold">Join</div>

		{% get_providers as socialaccount_providers %}
		{% if socialaccount_providers %}
		<div>
			{% include "socialaccount/snippets/provider_list.html" with process="login" text="Sign up with" %}
		</div>
		<hr>
		{% endif %}

		<p>description...</p>

		<form class="" id="signup_form" method="post" action="{% url 'account_signup' %}">
			{% csrf_token %}
			{{ form|crispy }}
			{% if redirect_field_value %}
			<input type="hidden" name="{{ redirect_field_name }}" value="{{ redirect_field_value }}" />
			{% endif %}
			<button type="submit"
				class="bg-indigo-600 hover:bg-indigo-500 text-white font-medium px-4 py-2 rounded tracking-wide"
				id="signupBtn">Create account</button>
		</form>

		<p class="">Have an account? <a href="{{ login_url }}" class="text-indigo-500 hover:text-indigo-600">Log in</a></p>

	</div>
</div>

{% endblock %}

{% block javascript %}
<script src="{% static 'js/utils.js' %}"></script>
<script>
	document.addEventListener('DOMContentLoaded', function () {
		addShowPassword("#id_password1")

		const emailInput = document.querySelector("#id_email")
		emailInput.focus()
	})

	const signupBtn = document.querySelector("#signupBtn")
	signupBtn.addEventListener('click', function () {
		if (this.form && isFormHtml5Valid(this.form, 'input')) {
			this.disabled = true
			this.textContent = "Creating..."
			this.form.submit()
		}
	})
</script>
{% endblock javascript %}